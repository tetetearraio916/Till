# 1章 DB設計総論
正規化を意識しながら、プログラミング言語の都合でデータ構造を崩さないかつプログラミング言語側に負担を かけないようなデータベース設計の実現の仕方を考える。

## DB設計の基本手順
データベース設計で大事な要点となるのは、「One Fact in One Place」。これを実現するのに用いる手法が正規化と言われるもの。正規化は、「データベースの部品化」を進めていくと捉えれば良い。

[正規化 「分かりそう」で「分からない」でも「分かった」気になれるIT用語辞典](https://wa3.i-3-i.info/word11632.html)

データベース設計の正規化に加えて2つの手法を導入する。

- IDの導入
-  業務の視点からの正規化

### IDの導入
従来の正規化にテーブル間の関連付けを行うと、関連付いたレコードの値をそのまま使ってしまってしまうことにより洗い換え問題というものに直面する。洗い換え問題とは、先述したような関連付けを行い、値を変更した時に参照先のテーブルの値も続けて入れ替えなければならないような問題を指します。そこでIDを導入することで、洗い換え問題を起こらないようにします。IDはレコードの存在を示すものです。また外部参照キー(FK)はそのレコードを参照するものなので、参照先の値を入れ替えても問題は発生しません。これによりテーブル同士を密結合から疎結合にすることが出来るのでデータ構造の変更自体が柔軟に行える。

### 業務の視点からの正規化
例えばある商品と単価を比較した時に、2枚の伝票に異なる単価があった場合が存在する。業務側の担当者に確認すると「単価は決まっていて、値引きする場合もある」と言う。ここに「単価が決まっている」と「値引きされた単価」という2つの事実が存在する。最初に先述した「One Fact in One Place」に従えば、同じ単価というレコードであったとしても事実が異なるのでこれは分けて保持すべきということになる。正規化にこだわるあまり、ひとつの事実を2つの場所に置くのを排除するという考えでは、プログラミング言語側で見分けるような実装になってしまうようなことにもなり得るので気を付けなければならない。

## DB設計の基礎知識
